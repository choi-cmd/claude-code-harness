{% extends "base.html" %}
{% block pwa %}
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ì£¼ë¬¸ ê´€ë¦¬">
    <link rel="apple-touch-icon" href="/static/images/icon-192.png">
    <link rel="manifest" href="/static/manifest-admin.json">
{% endblock %}

{% block content %}
<div class="admin-container">
    <div class="admin-header">
        <h1>ğŸ“‹ ì£¼ë¬¸ ìƒì„¸</h1>
        <div class="admin-actions">
            <a href="/admin/orders" class="btn-secondary">ëª©ë¡ìœ¼ë¡œ</a>
        </div>
    </div>

    <div class="order-detail-card">
        <div class="detail-section">
            <h2>ì£¼ë¬¸ ì •ë³´</h2>
            <table class="detail-table">
                <tr>
                    <td>ì£¼ë¬¸ë²ˆí˜¸</td>
                    <td><strong>{{ order.order_id }}</strong></td>
                </tr>
                <tr>
                    <td>ì£¼ë¬¸ì¼ì‹œ</td>
                    <td>{{ order.created_at }}</td>
                </tr>
                <tr>
                    <td>ìƒíƒœ</td>
                    <td>
                        <span class="status-badge status-{{ order.status }}">
                            {{ order.status }}
                        </span>
                    </td>
                </tr>
            </table>
        </div>

        <div class="detail-section">
            <h2>ê³ ê° ì •ë³´</h2>
            <table class="detail-table">
                <tr>
                    <td>ì´ë¦„</td>
                    <td><strong>{{ order.customer_name }}</strong></td>
                </tr>
                <tr>
                    <td>ì—°ë½ì²˜</td>
                    <td>{{ order.customer_phone }}</td>
                </tr>
                <tr>
                    <td>ì´ë©”ì¼</td>
                    <td>{{ order.customer_email }}</td>
                </tr>
            </table>
        </div>

        <div class="detail-section">
            <h2>ì œí’ˆ ì •ë³´</h2>
            <table class="detail-table">
                <tr>
                    <td>í¬ê¸°</td>
                    <td><strong>{{ order.width }}mm Ã— {{ order.height }}mm</strong></td>
                </tr>
                <tr>
                    <td>ì£¼ë¬¸ ìˆ˜ëŸ‰</td>
                    <td><strong>{{ order.quantity }}ê°œ</strong></td>
                </tr>
                <tr>
                    <td>ìµœì†Œ ìˆ˜ëŸ‰</td>
                    <td>{{ order.min_quantity }}ê°œ</td>
                </tr>
                <tr>
                    <td>ìƒ˜í”Œ ì œì‘</td>
                    <td>
                        {% if order.is_sample %}
                        <span class="badge-warning">ì˜ˆ (+10,000ì›)</span>
                        {% else %}
                        <span class="badge-success">ì•„ë‹ˆì˜¤</span>
                        {% endif %}
                    </td>
                </tr>
            </table>
        </div>

        <div class="detail-section">
            <h2>ê°€ê²© ì •ë³´</h2>
            <table class="detail-table">
                <tr>
                    <td>ê°œë‹¹ ë‹¨ê°€</td>
                    <td>{{ "{:,}".format(order.unit_price) }}ì›</td>
                </tr>
                <tr>
                    <td>ì´ ê¸ˆì•¡</td>
                    <td><strong class="text-primary">{{ "{:,}".format(order.total_price) }}ì›</strong></td>
                </tr>
            </table>
        </div>

        {% if order.file_path %}
        <div class="detail-section">
            <h2>ì²¨ë¶€ íŒŒì¼</h2>
            <div class="file-attachment">
                {% set ext = order.file_path.split('.')[-1].lower() %}
                {% if ext in ['png', 'jpg', 'jpeg', 'gif', 'bmp'] %}
                <div class="file-preview">
                    <img src="{{ order.file_path }}" alt="ì²¨ë¶€ ì´ë¯¸ì§€" class="preview-image">
                </div>
                {% endif %}
                <div class="file-actions">
                    <a href="{{ order.file_path }}" target="_blank" class="btn-download">ğŸ“ íŒŒì¼ ë³´ê¸°</a>
                    <a href="/admin/orders/{{ order.order_id }}/file" class="btn-download btn-download-file">ğŸ’¾ ë‹¤ìš´ë¡œë“œ</a>
                </div>
            </div>
        </div>
        {% endif %}

        {% if order.notes %}
        <div class="detail-section">
            <h2>ìš”ì²­ì‚¬í•­</h2>
            <div class="notes-box">
                {{ order.notes }}
            </div>
        </div>
        {% endif %}
    </div>
</div>

<style>
.order-detail-card {
    background: white;
    border-radius: 12px;
    padding: 32px;
}

.detail-section {
    margin-bottom: 32px;
    padding-bottom: 32px;
    border-bottom: 1px solid #e0e0e0;
}

.detail-section:last-child {
    border-bottom: none;
    margin-bottom: 0;
    padding-bottom: 0;
}

.detail-section h2 {
    font-size: 18px;
    color: #5C5C5C;
    margin-bottom: 16px;
}

.detail-table {
    width: 100%;
}

.detail-table tr {
    border-bottom: 1px solid #f0f0f0;
}

.detail-table td {
    padding: 12px 0;
}

.detail-table td:first-child {
    width: 30%;
    color: #666;
}

.badge-warning {
    padding: 4px 12px;
    background: #fff3cd;
    color: #856404;
    border-radius: 12px;
    font-size: 13px;
    font-weight: 600;
}

.badge-success {
    padding: 4px 12px;
    background: #d4edda;
    color: #155724;
    border-radius: 12px;
    font-size: 13px;
    font-weight: 600;
}

.file-attachment {
    padding: 16px;
    background: #f8f9fa;
    border-radius: 8px;
}

.file-preview {
    margin-bottom: 16px;
    text-align: center;
}

.preview-image {
    max-width: 100%;
    max-height: 400px;
    border-radius: 8px;
    border: 1px solid #e0e0e0;
}

.file-actions {
    display: flex;
    gap: 12px;
}

.btn-download {
    display: inline-block;
    padding: 10px 20px;
    background: #F4B900;
    color: #1A1A1A;
    text-decoration: none;
    border-radius: 6px;
    font-weight: 600;
}

.btn-download-file {
    background: #28a745;
    color: white;
}

.notes-box {
    padding: 16px;
    background: #f8f9fa;
    border-radius: 8px;
    line-height: 1.6;
}
</style>
{% endblock %}
